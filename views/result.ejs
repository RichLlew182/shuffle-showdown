<!DOCTYPE html>
<html lang="en">
<%- include('partials/head', { title: 'Results' }) %>

    <body>


        <% if (locals.artistInfo) { %>

            <header id="artistInfo">
                <div class="results-title">
                    <h1>
                        <%= artistInfo.name %>
                    </h1>
                    <a class="btn" href="/">Search Again</a>
                </div>

                <img class="rounded" src="<%= image %>" alt="" height="300" width="300">

                <p>
                    Followers: <%= artistInfo.followers.total %> Popularity: <%= artistInfo.popularity %>
                </p>
            </header>

            <section id="topTracks">

                <h3>Top 5 Tracks</h3>
                <% topTracks.forEach(track=> { %>

                    <% const formatDuration=(milliseconds)=> {
                        const minutes = Math.floor(milliseconds / 60000);
                        const seconds = Math.floor((milliseconds % 60000) / 1000);
                        return `${minutes}:${seconds < 10 ? '0' : '' }${seconds}`; }; const
                            durationInMs=track.duration_ms; formattedDuration=formatDuration(durationInMs); %>

                            <div class="card track">
                                <a href="<%= track.url %>" target="_blank" alt="Listen on Spotify">
                                    <img src="<%= track.image %>" alt="" height="80" width="80">
                                    <div class="track-info">
                                        <h4>
                                            <%= track.name %>
                                        </h4>
                                        <p class="duration">
                                            <%= formattedDuration %>
                                        </p>
                                    </div>
                                </a>
                            </div>


                            <% }) %>

            </section>

            <section id="appearsOn">

                <h3>Appears On</h3>
                <% appearsOn.forEach(album=> { %>

                    <div class="card album">
                        <a href="<%= album.url %>" target="_blank" alt="Listen on Spotify">
                            <img src="<%= album.image %>" alt="" height="80" width="80">
                            <div class="album-info">
                                <h4>
                                    <%= album.name %>
                                </h4>
                            </div>
                        </a>
                    </div>

                    <% }) %>

            </section>

            <section id="relatedArtists">

                <h3>Relatd Artists</h3>
                <% relatedArtists.forEach(artist=> { %>

                    <div class="card artist">
                        <a href="<%= artist.url %>" target="_blank" alt="Listen on Spotify">
                            <img class="rounded" src="<%= artist.image %>" alt="" height="80" width="80">
                            <div class="artist-info">
                                <h4>
                                    <%= artist.name %>
                                </h4>
                            </div>
                        </a>
                    </div>

                    <% }) %>

            </section>

            <% } else { %>

                <h1>No Results Found!</h1>

                <% } %>

    </body>

</html>